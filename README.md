# Authorization System
- 2022.12.22 ~ 
- 12.25일까지 1차로 프론트 없이 서버만 진행중입니다.

### 개요
12.25까지 1차로 구현한 내용은 다음과 같습니다.
- 사용자 가입. 가입하면서 비밀번호는 단방향 암호화.
- 사용자 로그인. 로그인 성공하면 쿠키에 토큰 저장. 토큰에는 권한만 저장.
- 인터셉터를 구현하여 컨트롤러 호출 전 로그인 상태 확인(인터셉터 1), 권한 확인(인터셉터 2).
- 관리자 권한 쿠키를 가지고 있어야 가입한 유저 정보 리스트 볼 수 있음.

### 기술스택
- Java 11
- Spring Boot 2.7.7
- Jpa
- spring-boot-starter-web
- lombok
- jaxb-api
- jjwt
- h2(콘솔은 되는데 spring에서 에러로 급하게 h2 사용했습니다. 연결만 mysql로 변경하면 됩니다!)

### 코드 중 확인받고 싶은 부분
1. low couping을 유지하자 생각하며 현재 컨트롤러와 서비스가 3개로 나누었는데 좋아보이지는 않습니다. 그냥 UserController와 HomeController를 합치고 Service도 하나로 다 합치는게 맞을지 궁금합니다. 
2. 기존에는 security에서 hasRole로 간단하게 권한을 확인했는데 사용하지 않게 되면서 권한 및 로그인 확인하는 반복작업을 줄이기 위해 첫번째 인터셉터에서 로그인 확인, 두번째 인터셉터에서 쿠키에 저장된 토큰으로 각 권한을 확인하고 있는데 이게 옳으면서 효율적인 일인지 궁금합니다.

### 개발관련 과정에서 궁금했던 부분
1. token 또한 탈취 위협이 있기 때문에 위험한 정보는 최소화 해야할 것입니다. 그래서 지금은 토큰에 권한정보만 저장하고 다른 사용자 정보는 세션이나 쿠키에 직접 저장하려고 합니다. 하지만 msa일 경우 세션 유지도 힘들고 모놀리식이더라도 굳이 세션에 나누어 저장할 필요가 있을지 궁금합니다.
2. 만약 refreshToken을 구현한다면 안의 데이터는 인증에는 사용할 수 없는 다시 access를 받을 수 있도록 하는 데이터만 필요할 것입니다. 단순하게 0,1 데이터로 재발급 가능 여부를 판단해도 될지 아니면 refreshToken안에도 지금 사용자와 대조하여 재발급 해주어야 할지 궁금합니다.
3. 비밀번호를 단방향 암호화 처리했는데 이럴경우 다시 복호화 하기는 힘들 것 입니다. 이런 상황에서 옵션으로 제시하신 비밀번호 찾기는 이메일 인증으로 확인 후 비밀번호 초기화가 정답이 될지 궁금합니다.
4. 제가 코드를 작성하는 과정이 해야할 화면(컨트롤러)을 정하고 그것에 따라 필요한 entity들을 정의하여 만들고 필요한 서비스를 만들면서 레포지토리도 만들고 그 후에 필터나 util들을 추가하고 있습니다. 짧은 시간동안 만들긴 했지만 생산성이 떨어진다고 생각했는데 능력 문제지만 나아질 방법이 있다면 말씀해 주시면 숙지하겠습니다!
